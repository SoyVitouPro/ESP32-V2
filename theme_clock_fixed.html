<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Digital Clock Theme - Standalone</title>
  <style>
    /* === STANDALONE THEME STYLES === */

    /* Reset and base styles */
    * { box-sizing: border-box; }
    body {
      margin: 0; padding: 20px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #0b0f14;
      color: #e7eef7;
      line-height: 1.5;
    }

    /* Theme preview container */
    .theme-container {
      max-width: 800px;
      margin: 0 auto;
      background: #121820;
      border-radius: 12px;
      border: 1px solid #1f2a35;
      overflow: hidden;
    }

    .theme-header {
      padding: 20px;
      background: #1a2332;
      border-bottom: 1px solid #2a3a4a;
      text-align: center;
    }

    .theme-title {
      margin: 0 0 10px 0;
      font-size: 24px;
      font-weight: 600;
      background: linear-gradient(45deg, #FF932E, #FF2E63, #2E9AFF);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .theme-subtitle {
      margin: 0;
      color: #8b92a3;
      font-size: 14px;
    }

    /* LED Preview Section */
    .preview-section {
      padding: 20px;
      text-align: center;
      background: #0d1117;
      border-bottom: 1px solid #1f2a35;
      overflow-x: auto; /* Allow horizontal scrolling for large canvas */
    }

    .preview-title {
      margin: 0 15px 15px 0;
      font-size: 16px;
      color: #8b92a3;
    }

    .led-preview {
      display: inline-block;
      background: #000;
      border: 2px solid #333;
      border-radius: 8px;
      padding: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      position: relative;
    }

    .led-preview::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-image:
        linear-gradient(to right, rgba(255,255,255,0.03) 1px, transparent 1px),
        linear-gradient(to bottom, rgba(255,255,255,0.03) 1px, transparent 1px);
      background-size: 20px 20px;
      pointer-events: none;
      z-index: 1;
    }

    #themeCanvas {
      display: block;
      image-rendering: pixelated;
      image-rendering: -moz-crisp-edges;
      image-rendering: crisp-edges;
      position: relative;
      z-index: 2;
      max-width: 100%;
      height: auto;
    }

    /* Theme Controls Section */
    .controls-section {
      padding: 20px;
      background: #1a2332;
    }

    .controls-title {
      margin: 0 0 20px 0;
      font-size: 18px;
      color: #e7eef7;
      text-align: center;
    }

    /* Theme Controls Grid */
    .theme-controls {
      background: #1a2332;
      padding: 16px;
      border-radius: 8px;
      border: 1px solid #2a3a4a;
      display: grid;
      gap: 16px;
    }

    .control {
      display: grid;
      gap: 8px;
    }

    .control-label {
      color: #8b92a3;
      font-size: 13px;
      font-weight: 500;
      margin-bottom: 4px;
    }

    /* Utility classes */
    .inline { display: flex; }
    .gap-8 { gap: 8px; }
    .gap-6 { gap: 6px; }
    .center { align-items: center; }
    .muted { color: #8b92a3; font-size: 12px; }
    .mono { font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, monospace; }
    .w-120 { min-width: 120px; }

    /* Theme Font Size Boxes */
    .theme-font-size-selection-wrapper {
      display: flex;
    }

    .theme-font-size-box {
      width: 40px;
      height: 32px;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s ease;
      position: relative;
      padding: 0;
      margin: 0;
      border: 2px solid #333;
      font-weight: 500;
      background: #233040;
      color: #e7eef7;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
    }

    .theme-font-size-box:hover {
      transform: scale(1.05);
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
      border-color: #555;
    }

    .theme-font-size-box.active {
      border-color: #FF932E !important;
      background: #FF932E !important;
      color: #000000 !important;
      box-shadow: 0 0 0 2px rgba(255,147,46,0.3), 0 2px 8px rgba(0,0,0,0.3);
      transform: scale(1.05);
    }

    /* Color Inputs */
    .color-input {
      width: 50px;
      height: 32px;
      border: 2px solid #333;
      border-radius: 6px;
      background: #233040;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .color-input:hover {
      border-color: #555;
      transform: scale(1.05);
    }

    /* Select and Checkbox styling */
    select {
      padding: 6px 12px;
      border: 1px solid #333;
      border-radius: 6px;
      background: #233040;
      color: #e7eef7;
      font-size: 13px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    select:hover {
      border-color: #555;
    }

    select:focus {
      outline: none;
      border-color: #FF932E;
      box-shadow: 0 0 0 2px rgba(255,147,46,0.2);
    }

    input[type="checkbox"] {
      width: 16px;
      height: 16px;
      margin: 0;
      cursor: pointer;
    }

    label {
      cursor: pointer;
      user-select: none;
    }

    /* FPS hint (hidden from UI, for main system) */
    .fps-hint {
      display: none;
    }
  </style>
</head>
<body>
  <!-- FPS hint read by the uploader UI (1-30). -->
  <div class="fps-hint">1</div>

  <div class="theme-container">
    <!-- Theme Header -->
    <div class="theme-header">
      <h1 class="theme-title">üïê Digital Clock Theme</h1>
      <p class="theme-subtitle">Standalone Clock Theme with Built-in Controls</p>
    </div>

    <!-- LED Preview Section -->
    <div class="preview-section">
      <div class="inline gap-8 center" style="justify-content: center; align-items: flex-start;">
        <h2 class="preview-title">LED Panel Preview (128√ó64)</h2>
        <div class="muted" style="font-size: 12px; margin-top: 4px;">üìè Scale: 1 LED = 20px (Total: 2560√ó1280px)</div>
      </div>
      <div class="led-preview">
        <canvas id="themeCanvas" width="2560" height="1280"></canvas>
      </div>
    </div>

    <!-- Theme Controls Section -->
    <div class="controls-section">
      <h2 class="controls-title">Theme Controls</h2>

      <div class="theme-controls">
        <!-- Font Size Control -->
        <div class="control">
          <div class="control-label">üî† Font Size</div>
          <div class="theme-font-size-selection-wrapper">
            <div class="inline gap-8">
              <button class="theme-font-size-box" data-size="15">15</button>
              <button class="theme-font-size-box active" data-size="20">20</button>
              <button class="theme-font-size-box" data-size="35">35</button>
              <button class="theme-font-size-box" data-size="60">60</button>
            </div>
          </div>
        </div>

        <!-- Text Color Control -->
        <div class="control">
          <div class="control-label">üé® Text Color</div>
          <div class="inline gap-8 center">
            <input id="themeTextColor" type="color" value="#00ff00" class="color-input">
            <span id="textColorHex" class="muted mono">#00ff00</span>
          </div>
        </div>

        <!-- Background Color Control -->
        <div class="control">
          <div class="control-label">üñºÔ∏è Background</div>
          <div class="inline gap-8 center">
            <input id="themeBgColor" type="color" value="#000000" class="color-input">
            <span id="bgColorHex" class="muted mono">#000000</span>
          </div>
        </div>

        <!-- Time Format -->
        <div class="control">
          <div class="control-label">üïê Time Format</div>
          <div class="inline gap-8 center">
            <select id="themeTimeFormat" class="w-120">
              <option value="24">24-hour</option>
              <option value="12">12-hour</option>
            </select>
            <label class="muted inline gap-6">
              <input type="checkbox" id="themeShowSeconds" checked> Show Seconds
            </label>
          </div>
        </div>

        <!-- Effects -->
        <div class="control">
          <div class="control-label">‚ú® Effects</div>
          <label class="muted inline gap-6">
            <input type="checkbox" id="themePulseAnimation"> Pulse
          </label>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ========================================
    // DIGITAL CLOCK THEME - STANDALONE VERSION
    // ========================================

    // Theme Settings (will be updated by controls)
    let themeSettings = {
      textColor: '#00ff00',
      bgColor: '#000000',
      fontSize: 20,
      fontFamily: 'Arial, sans-serif',
      fontWeight: 'bold',
      timeFormat: '24',
      showSeconds: true,
      shadowBlur: 1,
      pulseAnimation: false
    };

    // Canvas context for preview (only available in standalone mode)
    const canvas = document.getElementById('themeCanvas');
    const ctx = canvas ? canvas.getContext('2d') : null;
    let animationFrame = null;
    let pulseScale = 1.0;
    let pulseDirection = 1;
    let lastUpdateTime = 0;
    const TARGET_FPS = 30; // Consistent 30 FPS for smooth animation
    const FRAME_INTERVAL = 1000 / TARGET_FPS; // ~33ms per frame

    // LED grid scaling (only used in standalone mode)
    const LED_SIZE = 20; // Each LED pixel is 20px
    const LED_PANEL_WIDTH = 128; // Original LED panel width
    const LED_PANEL_HEIGHT = 64; // Original LED panel height
    const CANVAS_SCALE = LED_SIZE; // Scale factor for rendering

    // Check if running in standalone mode
    const isStandaloneMode = !!canvas;

    // Color Presets (for reference)
    const colorPresets = {
      classic: { text: '#00ff00', bg: '#000000', name: 'Classic' },
      neon: { text: '#ff00ff', bg: '#0a0014', name: 'Neon' },
      ocean: { text: '#00ffff', bg: '#001a33', name: 'Ocean' },
      sunset: { text: '#ff6b35', bg: '#1a0a00', name: 'Sunset' },
      matrix: { text: '#00ff41', bg: '#000000', name: 'Matrix' }
    };

    // Helper Functions
    function pad(n) { return (n < 10 ? '0' : '') + n; }

    function formatTime(fmt, d, showSeconds) {
      let h = d.getHours();
      let m = d.getMinutes();
      let s = d.getSeconds();
      let suffix = '';

      if (fmt === '12') {
        suffix = (h < 12) ? ' AM' : ' PM';
        h = h % 12;
        if (h === 0) h = 12;
      }

      let timeStr = pad(h) + ':' + pad(m);
      if (showSeconds) timeStr += ':' + pad(s);
      timeStr += suffix;

      return timeStr;
    }

    function calculateFontSize(w, h, size) {
      const sizeMap = { 15: 0.25, 20: 0.35, 35: 0.50, 60: 0.75 };
      const ratio = sizeMap[size] || 0.50;
      return Math.min(Math.floor(h * ratio), Math.floor(w * 0.6));
    }

    // === THEME RENDERING FUNCTION ===
    function renderTheme(ctx, w, h, t) {
      const now = new Date(t || Date.now());

      // Create off-screen canvas for LED panel resolution (128x64)
      const offscreenCanvas = document.createElement('canvas');
      offscreenCanvas.width = LED_PANEL_WIDTH;
      offscreenCanvas.height = LED_PANEL_HEIGHT;
      const offscreenCtx = offscreenCanvas.getContext('2d');

      // Render at LED panel resolution first
      renderToLEDPanel(offscreenCtx, LED_PANEL_WIDTH, LED_PANEL_HEIGHT, now);

      // Then scale up to display canvas with pixelated rendering
      ctx.imageSmoothingEnabled = false; // Keep pixels sharp
      ctx.drawImage(offscreenCanvas, 0, 0, w, h);
    }

    // Function to render at actual LED panel resolution (128x64)
    function renderToLEDPanel(ctx, w, h, now) {
      // Background
      ctx.fillStyle = themeSettings.bgColor;
      ctx.fillRect(0, 0, w, h);

      // Setup text for LED panel resolution
      let fontSize = calculateFontSize(w, h, themeSettings.fontSize);

      // Apply pulse animation if enabled
      if (themeSettings.pulseAnimation) {
        fontSize = Math.floor(fontSize * pulseScale);
      }

      ctx.font = `${themeSettings.fontWeight} ${fontSize}px ${themeSettings.fontFamily}`;
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      ctx.fillStyle = themeSettings.textColor;

      // Center position with font size adjustment
      let centerY = h / 2;
      if (themeSettings.fontSize <= 15) centerY -= 1;
      else if (themeSettings.fontSize <= 20) centerY -= 0;

      // Shadow effect
      if (themeSettings.shadowBlur > 0) {
        ctx.shadowColor = themeSettings.shadowColor || '#000000';
        ctx.shadowBlur = themeSettings.shadowBlur;
        ctx.fillText(formatTime(themeSettings.timeFormat, now, themeSettings.showSeconds), w / 2, centerY);
        ctx.shadowBlur = 0;
      } else {
        ctx.fillText(formatTime(themeSettings.timeFormat, now, themeSettings.showSeconds), w / 2, centerY);
      }
    }

    // === PREVIEW ANIMATION (standalone mode only) ===
    function animate(currentTime) {
      // Only animate if in standalone mode and canvas exists
      if (!isStandaloneMode || !ctx) return;

      // Check if enough time has passed for the target FPS
      if (currentTime - lastUpdateTime >= FRAME_INTERVAL) {
        // Update pulse animation (with delta time for consistent speed)
        if (themeSettings.pulseAnimation) {
          const deltaTime = (currentTime - lastUpdateTime) / 1000; // Convert to seconds
          pulseScale += 0.5 * deltaTime * pulseDirection; // 0.5 units per second
          if (pulseScale >= 1.1 || pulseScale <= 0.9) {
            pulseDirection *= -1;
          }
        } else {
          pulseScale = 1.0;
        }

        // Render frame
        renderTheme(ctx, canvas.width, canvas.height);

        // Update last frame time
        lastUpdateTime = currentTime;
      }

      // Continue animation
      animationFrame = requestAnimationFrame(animate);
    }

    // === THEME SETTINGS UPDATE ===
    function updateThemeSettingFunction(setting, value) {
      themeSettings[setting] = value;
      console.log(`Theme setting updated: ${setting} = ${value}`);

      // Store settings globally so they persist in main system
      if (typeof window !== 'undefined') {
        window._digitalClockThemeSettings = { ...themeSettings };
      }

      // Update displays (only in standalone mode)
      if (isStandaloneMode) {
        if (setting === 'textColor') {
          document.getElementById('textColorHex').textContent = value;
        } else if (setting === 'bgColor') {
          document.getElementById('bgColorHex').textContent = value;
        }
      }
    }

    // === CONTROL EVENT HANDLERS (standalone mode only) ===
    function setupThemeControlHandlers() {
      // Only setup handlers in standalone mode
      if (!isStandaloneMode) {
        console.log('üéõÔ∏è Skipping control handlers - running in main system mode');
        return;
      }

      console.log('üéõÔ∏è Setting up theme control handlers...');

      // Font size buttons
      const fontSizeButtons = document.querySelectorAll('.theme-font-size-box');
      fontSizeButtons.forEach((button) => {
        button.addEventListener('click', function() {
          // Remove active class from all buttons
          fontSizeButtons.forEach(btn => btn.classList.remove('active'));
          // Add active class to clicked button
          this.classList.add('active');
          // Update theme setting
          const size = parseInt(this.getAttribute('data-size'));
          updateThemeSettingFunction('fontSize', size);
        });
      });

      // Text color
      const themeTextColor = document.getElementById('themeTextColor');
      const textColorHex = document.getElementById('textColorHex');
      if (themeTextColor && textColorHex) {
        themeTextColor.addEventListener('input', (e) => {
          updateThemeSettingFunction('textColor', e.target.value);
        });
      }

      // Background color
      const themeBgColor = document.getElementById('themeBgColor');
      const bgColorHex = document.getElementById('bgColorHex');
      if (themeBgColor && bgColorHex) {
        themeBgColor.addEventListener('input', (e) => {
          updateThemeSettingFunction('bgColor', e.target.value);
        });
      }

      // Time format
      const themeTimeFormat = document.getElementById('themeTimeFormat');
      if (themeTimeFormat) {
        themeTimeFormat.addEventListener('change', (e) => {
          updateThemeSettingFunction('timeFormat', e.target.value);
        });
      }

      // Show seconds
      const themeShowSeconds = document.getElementById('themeShowSeconds');
      if (themeShowSeconds) {
        themeShowSeconds.addEventListener('change', (e) => {
          updateThemeSettingFunction('showSeconds', e.target.checked);
        });
      }

      // Pulse animation
      const themePulseAnimation = document.getElementById('themePulseAnimation');
      if (themePulseAnimation) {
        themePulseAnimation.addEventListener('change', (e) => {
          updateThemeSettingFunction('pulseAnimation', e.target.checked);
        });
      }

      console.log('‚úÖ Theme control handlers setup complete');
    }

    // === IMMEDIATE FUNCTION OVERRIDE (for main system integration) ===
    // This runs immediately when script is evaluated, before themeInit()
    if (typeof window !== 'undefined') {
      console.log('üîß Setting up immediate function override for main system integration');

      // Save any existing main system updateThemeSetting function
      const originalUpdateThemeSetting = window.updateThemeSetting;
      console.log('üìã Saved original updateThemeSetting:', typeof originalUpdateThemeSetting);

      // Create enhanced updateThemeSetting that calls both functions
      window.updateThemeSetting = function(setting, value) {
        console.log('üîÑ Enhanced updateThemeSetting called:', setting, '=', value);
        console.log('üîç Original function exists:', typeof originalUpdateThemeSetting);

        // Call our theme's internal updateThemeSettingFunction first to persist globally
        if (typeof updateThemeSettingFunction === 'function') {
          updateThemeSettingFunction(setting, value);
          console.log('‚úÖ Theme function called, updated settings:', themeSettings);
        } else {
          console.log('‚ùå Theme updateThemeSettingFunction not found!');
        }

        // Then call the original main system function for preview updates
        if (typeof originalUpdateThemeSetting === 'function') {
          originalUpdateThemeSetting(setting, value);
          console.log('‚úÖ Original main system function called');
        } else {
          console.log('‚ùå Original main system function not found!');
        }
      };

      console.log('üîß Enhanced updateThemeSetting with theme persistence enabled immediately');
    }

    // === REQUIRED THEME FUNCTIONS (for main system) ===
    function themeInit() {
      console.log('üïê Digital Clock Theme Initialized (Standalone)');

      // Load persisted settings if available
      if (typeof window !== 'undefined' && window._digitalClockThemeSettings) {
        Object.assign(themeSettings, window._digitalClockThemeSettings);
        console.log('üìã Loaded persisted theme settings:', themeSettings);
      } else {
        console.log('üìã Using default theme settings:', themeSettings);
      }

      return { settings: { ...themeSettings } };
    }

    function themeRender(ctx, w, h, state, t) {
      // Use settings from state if provided, otherwise use current theme settings
      const settings = state.settings || themeSettings;

      // Merge current theme settings with provided state
      const mergedSettings = { ...themeSettings, ...settings };

      const now = new Date(t || Date.now());

      // Background
      ctx.fillStyle = mergedSettings.bgColor;
      ctx.fillRect(0, 0, w, h);

      // Setup text
      let fontSize = calculateFontSize(w, h, mergedSettings.fontSize);

      // Apply pulse animation if enabled (for main system, use simple pulse)
      if (mergedSettings.pulseAnimation) {
        const pulse = 0.95 + 0.05 * Math.sin(Date.now() / 500); // Simple pulse for main system
        fontSize = Math.floor(fontSize * pulse);
      }

      ctx.font = `${mergedSettings.fontWeight} ${fontSize}px ${mergedSettings.fontFamily}`;
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      ctx.fillStyle = mergedSettings.textColor;

      // Center position with font size adjustment
      let centerY = h / 2;
      if (mergedSettings.fontSize <= 15) centerY -= 1;
      else if (mergedSettings.fontSize <= 20) centerY -= 0;

      // Shadow effect
      if (mergedSettings.shadowBlur > 0) {
        ctx.shadowColor = mergedSettings.shadowColor || '#000000';
        ctx.shadowBlur = mergedSettings.shadowBlur;
        ctx.fillText(formatTime(mergedSettings.timeFormat, now, mergedSettings.showSeconds), w / 2, centerY);
        ctx.shadowBlur = 0;
      } else {
        ctx.fillText(formatTime(mergedSettings.timeFormat, now, mergedSettings.showSeconds), w / 2, centerY);
      }
    }

    // === INITIALIZATION ===
    function initializeTheme() {
      if (isStandaloneMode) {
        console.log('üöÄ Initializing Standalone Digital Clock Theme...');

        // Load persisted settings if available
        if (typeof window !== 'undefined' && window._digitalClockThemeSettings) {
          Object.assign(themeSettings, window._digitalClockThemeSettings);
          console.log('üìã Loaded persisted settings on init:', themeSettings);
        }

        // Setup control handlers
        setupThemeControlHandlers();

        // Set initial values from controls (or use persisted values)
        const savedTextColor = document.getElementById('themeTextColor').value;
        const savedBgColor = document.getElementById('themeBgColor').value;
        const savedTimeFormat = document.getElementById('themeTimeFormat').value;
        const savedShowSeconds = document.getElementById('themeShowSeconds').checked;
        const savedPulseAnimation = document.getElementById('themePulseAnimation').checked;

        // Update themeSettings with control values (or use existing if already set)
        if (!themeSettings.textColor || themeSettings.textColor === '#00ff00') {
          updateThemeSettingFunction('textColor', savedTextColor);
        }
        if (!themeSettings.bgColor || themeSettings.bgColor === '#000000') {
          updateThemeSettingFunction('bgColor', savedBgColor);
        }
        if (!themeSettings.timeFormat) {
          updateThemeSettingFunction('timeFormat', savedTimeFormat);
        }
        if (typeof themeSettings.showSeconds === 'undefined') {
          updateThemeSettingFunction('showSeconds', savedShowSeconds);
        }
        if (typeof themeSettings.pulseAnimation === 'undefined') {
          updateThemeSettingFunction('pulseAnimation', savedPulseAnimation);
        }

        // Start animation with proper timing initialization
        lastUpdateTime = performance.now();
        animate(lastUpdateTime);

        console.log('‚úÖ Standalone Digital Clock Theme loaded and ready!');
      } else {
        console.log('üì¶ Digital Clock Theme loaded for main system');
      }

      console.log('üîß themeInit exists:', typeof themeInit);
      console.log('üé≠ themeRender exists:', typeof themeRender);

      // Expose theme's internal updateThemeSettingFunction for direct access
      if (typeof window !== 'undefined') {
        window._themeInternalUpdateSetting = updateThemeSettingFunction;
        console.log('üåê Theme internal updateSetting exposed as _themeInternalUpdateSetting');

        // Add debug function to test control clicks
        window.debugThemeControl = function(setting, value) {
          console.log('üß™ DEBUG: Testing theme control directly');
          console.log('Setting:', setting, 'Value:', value);
          console.log('Current themeSettings before:', themeSettings);

          if (typeof updateThemeSettingFunction === 'function') {
            updateThemeSettingFunction(setting, value);
            console.log('‚úÖ DEBUG: Theme settings after:', themeSettings);
          } else {
            console.log('‚ùå DEBUG: updateThemeSettingFunction not available');
          }
        };

        // Add function to check what main system controls are doing
        window.debugMainSystemControls = function() {
          const buttons = document.querySelectorAll('.theme-font-size-box');
          console.log('üîç DEBUG: Found theme font size buttons:', buttons.length);
          buttons.forEach((btn, i) => {
            console.log(`Button ${i}:`, btn.textContent, 'data-size:', btn.dataset.size, 'active:', btn.classList.contains('active'));
            // Test clicking button manually
            btn.addEventListener('click', function() {
              console.log('üñ±Ô∏è DEBUG: Font size button clicked manually!', this.dataset.size);
              if (typeof window.updateThemeSetting === 'function') {
                window.updateThemeSetting('fontSize', parseInt(this.dataset.size));
              } else {
                console.log('‚ùå DEBUG: window.updateThemeSetting not found!');
              }
            });
          });
        };

        // Add function to manually test font size changes
        window.debugFontSizeChange = function(size) {
          console.log('üß™ DEBUG: Manually testing font size change to:', size);
          if (typeof window.updateThemeSetting === 'function') {
            window.updateThemeSetting('fontSize', size);
            console.log('‚úÖ DEBUG: updateThemeSetting called');
          } else {
            console.log('‚ùå DEBUG: window.updateThemeSetting not found!');
          }
        };

        console.log('üß™ Debug functions added: debugThemeControl(), debugMainSystemControls()');
      }
    }

    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initializeTheme);
    } else {
      initializeTheme();
    }
  </script>
</body>
</html>