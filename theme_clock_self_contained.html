<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Self-Contained Digital Clock Theme</title>
</head>
<body>
  <!-- FPS hint read by the uploader UI (1-30). -->
  <fps>1</fps>

  <script>
    // ========================================
    // SELF-CONTAINED DIGITAL CLOCK THEME
    // ========================================

    // Theme Configuration
    let themeSettings = {
      textColor: '#00ff00',           // Clock text color
      bgColor: '#000000',             // Background color
      fontSize: 35,                   // Font size (15, 20, 35, 60)
      fontFamily: 'Arial, sans-serif',
      fontWeight: 'bold',
      timeFormat: '24',               // '24' or '12' hour format
      showSeconds: true,              // Show seconds
      shadowColor: '#004400',         // Text shadow color
      shadowBlur: 2,                  // Text shadow blur amount
      glowIntensity: 0,                // Text glow intensity (0-5)
      scanLines: true,                 // Show scan lines effect
      corners: false                  // Show corner accents
    };

    // Color Presets
    const colorPresets = {
      classic: { text: '#00ff00', bg: '#000000', shadow: '#004400', name: 'Classic Green' },
      neon: { text: '#ff00ff', bg: '#0a0014', shadow: '#ff00ff', name: 'Neon Purple' },
      ocean: { text: '#00ffff', bg: '#001a33', shadow: '#004466', name: 'Ocean Cyan' },
      sunset: { text: '#ff6b35', bg: '#1a0a00', shadow: '#663300', name: 'Sunset Orange' },
      matrix: { text: '#00ff41', bg: '#000000', shadow: '#00ff00', name: 'Matrix Green' },
      fire: { text: '#ff4500', bg: '#330000', shadow: '#ff6600', name: 'Fire Red' },
      ice: { text: '#87ceeb', bg: '#001122', shadow: '#4682b4', name: 'Ice Blue' },
      gold: { text: '#ffd700', bg: '#1a1a00', shadow: '#ccaa00', name: 'Royal Gold' }
    };

    let currentPreset = 'classic';
    let animationFrame = 0;

    // Helper Functions
    function pad(n) { return (n < 10 ? '0' : '') + n; }

    function formatTime(fmt, d, showSeconds) {
      let h = d.getHours();
      let m = d.getMinutes();
      let s = d.getSeconds();
      let suffix = '';

      if (fmt === '12') {
        suffix = (h < 12) ? ' AM' : ' PM';
        h = h % 12;
        if (h === 0) h = 12;
      }

      let timeStr = pad(h) + ':' + pad(m);
      if (showSeconds) timeStr += ':' + pad(s);
      timeStr += suffix;

      return timeStr;
    }

    function calculateFontSize(w, h, size) {
      const sizeMap = { 15: 0.18, 20: 0.28, 35: 0.44, 60: 0.75 };
      const ratio = sizeMap[size] || 0.44;
      return Math.floor(h * ratio);
    }

    function applyTextEffects(ctx, text, x, y, settings) {
      // Apply shadow if enabled
      if (settings.shadowBlur > 0) {
        ctx.shadowColor = settings.shadowColor;
        ctx.shadowBlur = settings.shadowBlur;
        ctx.fillText(text, x, y);
        ctx.shadowBlur = 0;
      }

      // Apply glow if enabled
      if (settings.glowIntensity > 0) {
        ctx.shadowColor = settings.textColor;
        ctx.shadowBlur = settings.glowIntensity;
        ctx.fillText(text, x, y);
        ctx.shadowBlur = 0;
      }

      // Main text
      ctx.fillText(text, x, y);
    }

    // Theme Rendering Function
    function themeRender(ctx, w, h, t) {
      const settings = themeSettings;
      const now = new Date(t || Date.now());

      // Create gradient background
      const gradient = ctx.createLinearGradient(0, 0, w, h);
      gradient.addColorStop(0, settings.bgColor);
      gradient.addColorStop(0.5, shadeColor(settings.bgColor, -20));
      gradient.addColorStop(1, shadeColor(settings.bgColor, -40));
      ctx.fillStyle = gradient;
      ctx.fillRect(0, 0, w, h);

      // Add scan lines effect
      if (settings.scanLines) {
        ctx.strokeStyle = 'rgba(255, 255, 255, 0.02)';
        ctx.lineWidth = 1;
        for (let y = 0; y < h; y += 2) {
          ctx.beginPath();
          ctx.moveTo(0, y);
          ctx.lineTo(w, y);
          ctx.stroke();
        }
      }

      // Setup text
      const fontSize = calculateFontSize(w, h, settings.fontSize);
      ctx.font = `${settings.fontWeight} ${fontSize}px ${settings.fontFamily}`;
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      ctx.fillStyle = settings.textColor;

      // Center position with adjustment for font size
      let centerY = h / 2;
      if (settings.fontSize <= 15) centerY -= 1;
      else if (settings.fontSize <= 20) centerY -= 0;

      // Render time
      const timeString = formatTime(settings.timeFormat, now, settings.showSeconds);
      applyTextEffects(ctx, timeString, w / 2, centerY, settings);

      // Add corner accents if enabled
      if (settings.corners && settings.glowIntensity > 2) {
        ctx.strokeStyle = settings.textColor;
        ctx.lineWidth = 1;
        ctx.globalAlpha = 0.3;

        // Corner decorations
        const cornerSize = 8;
        [[5, 5, cornerSize, 0], [w - 5, 5, 0, cornerSize],
         [5, h - 5, cornerSize, 0], [w - 5, h - 5, 0, cornerSize]].forEach(([x, y, dx, dy]) => {
          ctx.beginPath();
          ctx.moveTo(x, y);
          ctx.lineTo(x + dx, y);
          ctx.lineTo(x, y + dy);
          ctx.stroke();
        });

        ctx.globalAlpha = 1.0;
      }
    }

    function shadeColor(color, percent) {
      const num = parseInt(color.replace('#', ''), 16);
      const amt = Math.round(2.55 * percent);
      const R = Math.min(255, Math.max(0, (num >> 16) + amt));
      const G = Math.min(255, Math.max(0, (num >> 8 & 0x00FF) + amt));
      const B = Math.min(255, Math.max(0, (num & 0x0000FF) + amt));
      return '#' + ((R << 16) | (G << 8) | B).toString(16).padStart(6, '0');
    }

    // === REQUIRED THEME FUNCTIONS ===
    function themeInit() {
      console.log('üïê Self-Contained Clock Theme Initialized');
      return { settings: themeSettings };
    }

    function themeRender(ctx, w, h, state, t) {
      return themeRender(ctx, w, h, t);
    }

    // === THEME CONTROL SYSTEM ===
    const ThemeControlSystem = {
      init() {
        this.injectStyles();
        this.createControls();
        this.bindEvents();
      },

      injectStyles() {
        if (document.getElementById('theme-styles')) return;

        const styles = document.createElement('style');
        styles.id = 'theme-styles';
        styles.textContent = `
          .theme-container {
            position: fixed;
            top: 10px;
            right: 10px;
            width: 280px;
            max-height: 80vh;
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.9);
            border: 2px solid #333;
            border-radius: 8px;
            padding: 15px;
            color: #fff;
            font-family: 'Arial, sans-serif';
            font-size: 12px;
            z-index: 10000;
            box-shadow: 0 4px 20px rgba(0,0,0,0.5);
          }
          .theme-header {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
            color: #00ff00;
            border-bottom: 1px solid #333;
            padding-bottom: 10px;
          }
          .theme-section {
            margin: 12px 0;
          }
          .theme-section-title {
            font-weight: bold;
            margin-bottom: 8px;
            color: #aaa;
            font-size: 11px;
          }
          .theme-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(60px, 1fr));
            gap: 6px;
          }
          .theme-btn {
            padding: 6px 8px;
            border: 1px solid #444;
            border-radius: 4px;
            background: #222;
            color: #fff;
            cursor: pointer;
            font-size: 10px;
            font-weight: bold;
            transition: all 0.2s;
            text-align: center;
          }
          .theme-btn:hover {
            background: #333;
            border-color: #666;
            transform: translateY(-1px);
          }
          .theme-btn.active {
            background: #004400;
            border-color: #00ff00;
            box-shadow: 0 0 5px rgba(0,255,0,0.3);
          }
          .theme-preview {
            width: 100%;
            height: 60px;
            border: 1px solid #444;
            border-radius: 4px;
            margin: 10px 0;
            background: #000;
            position: relative;
            overflow: hidden;
          }
          .theme-close {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 20px;
            height: 20px;
            background: #ff0000;
            border: none;
            border-radius: 50%;
            color: #fff;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
          }
          .theme-close:hover {
            background: #ff4444;
          }
        `;
        document.head.appendChild(styles);
      },

      createControls() {
        const container = document.createElement('div');
        container.className = 'theme-container';
        container.id = 'theme-controls';
        container.innerHTML = `
          <div class="theme-header">
            üïê Clock Theme Controls
            <button class="theme-close" onclick="this.parentElement.parentElement.style.display='none'">√ó</button>
          </div>

          <div class="theme-section">
            <div class="theme-section-title">üî† Font Size</div>
            <div class="theme-buttons">
              <button class="theme-btn ${themeSettings.fontSize === 15 ? 'active' : ''}" data-size="15">15</button>
              <button class="theme-btn ${themeSettings.fontSize === 20 ? 'active' : ''}" data-size="20">20</button>
              <button class="theme-btn ${themeSettings.fontSize === 35 ? 'active' : ''}" data-size="35">35</button>
              <button class="theme-btn ${themeSettings.fontSize === 60 ? 'active' : ''}" data-size="60">60</button>
            </div>
          </div>

          <div class="theme-section">
            <div class="theme-section-title">üé® Color Themes</div>
            <div class="theme-buttons">
              <button class="theme-btn ${currentPreset === 'classic' ? 'active' : ''}" data-preset="classic" style="background:#00ff00;color:#000">Classic</button>
              <button class="theme-btn ${currentPreset === 'neon' ? 'active' : ''}" data-preset="neon" style="background:#ff00ff;color:#fff">Neon</button>
              <button class="theme-btn ${currentPreset === 'ocean' ? 'active' : ''}" data-preset="ocean" style="background:#00ffff;color:#000">Ocean</button>
              <button class="theme-btn ${currentPreset === 'sunset' ? 'active' : ''}" data-preset="sunset" style="background:#ff6b35;color:#fff">Sunset</button>
              <button class="theme-btn ${currentPreset === 'matrix' ? 'active' : ''}" data-preset="matrix" style="background:#00ff41;color:#000">Matrix</button>
              <button class="theme-btn ${currentPreset === 'fire' ? 'active' : ''}" data-preset="fire" style="background:#ff4500;color:#fff">Fire</button>
              <button class="theme-btn ${currentPreset === 'ice' ? 'active' : ''}" data-preset="ice" style="background:#87ceeb;color:#000">Ice</button>
              <button class="theme-btn ${currentPreset === 'gold' ? 'active' : ''}" data-preset="gold" style="background:#ffd700;color:#000">Gold</button>
            </div>
          </div>

          <div class="theme-section">
            <div class="theme-section-title">üïê Time Format</div>
            <div class="theme-buttons">
              <button class="theme-btn ${themeSettings.timeFormat === '24' ? 'active' : ''}" data-format="24">24H</button>
              <button class="theme-btn ${themeSettings.timeFormat === '12' ? 'active' : ''}" data-format="12">12H</button>
              <button class="theme-btn ${themeSettings.showSeconds ? 'active' : ''}" data-seconds="false">No Sec</button>
            </div>
          </div>

          <div class="theme-section">
            <div class="theme-section-title">‚ú® Effects</div>
            <div class="theme-buttons">
              <button class="theme-btn ${themeSettings.scanLines ? 'active' : ''}" data-effect="scanLines">Scan</button>
              <button class="theme-btn ${themeSettings.corners ? 'active' : ''}" data-effect="corners">Corners</button>
              <button class="theme-btn ${themeSettings.glowIntensity > 0 ? 'active' : ''}" data-glow="2">Glow</button>
            </div>
          </div>

          <div class="theme-preview"></div>
        `;
        document.body.appendChild(container);
      },

      bindEvents() {
        const container = document.getElementById('theme-controls');
        if (!container) return;

        // Font size buttons
        container.querySelectorAll('[data-size]').forEach(btn => {
          btn.addEventListener('click', () => {
            const size = parseInt(btn.dataset.size);
            themeSettings.fontSize = size;
            this.updateButtonState(container.querySelectorAll('[data-size]'), btn);
            console.log('Font size changed to:', size);
          });
        });

        // Color preset buttons
        container.querySelectorAll('[data-preset]').forEach(btn => {
          btn.addEventListener('click', () => {
            const preset = btn.dataset.preset;
            this.applyColorPreset(preset);
            this.updateButtonState(container.querySelectorAll('[data-preset]'), btn);
          });
        });

        // Format buttons
        container.querySelectorAll('[data-format]').forEach(btn => {
          btn.addEventListener('click', () => {
            themeSettings.timeFormat = btn.dataset.format;
            this.updateButtonState(container.querySelectorAll('[data-format]'), btn);
            console.log('Time format changed to:', btn.dataset.format);
          });
        });

        // Seconds button
        container.querySelectorAll('[data-seconds]').forEach(btn => {
          btn.addEventListener('click', () => {
            themeSettings.showSeconds = btn.dataset.seconds === 'true';
            btn.textContent = themeSettings.showSeconds ? 'No Sec' : 'Show Sec';
            btn.setAttribute('data-seconds', themeSettings.showSeconds ? 'false' : 'true');
            this.updateButtonState(container.querySelectorAll('[data-seconds]'), btn);
            console.log('Show seconds changed to:', themeSettings.showSeconds);
          });
        });

        // Effects buttons
        container.querySelectorAll('[data-effect]').forEach(btn => {
          btn.addEventListener('click', () => {
            const effect = btn.dataset.effect;
            themeSettings[effect] = !themeSettings[effect];
            this.updateButtonState([btn], btn);

            // Handle glow intensity
            if (effect === 'glow') {
              themeSettings.glowIntensity = themeSettings.glowIntensity > 0 ? 0 : 2;
            }
            console.log(`Effect ${effect} changed to:`, themeSettings[effect]);
          });
        });
      },

      updateButtonState(buttons, activeBtn) {
        buttons.forEach(btn => btn.classList.remove('active'));
        activeBtn.classList.add('active');
      },

      applyColorPreset(presetName) {
        const preset = colorPresets[presetName];
        if (preset) {
          Object.assign(themeSettings, {
            textColor: preset.text,
            bgColor: preset.bg,
            shadowColor: preset.shadow
          });
          currentPreset = presetName;
          console.log('Color preset applied:', presetName);
        }
      },

      updatePreview() {
        const preview = document.querySelector('.theme-preview');
        if (!preview) return;

        const ctx = preview.getContext('2d');
        const width = 280;
        const height = 60;

        themeRender(ctx, width, height, null, Date.now());
      }
    };

    // Initialize the theme control system
    if (typeof window !== 'undefined') {
      window.themeControlSystem = ThemeControlSystem;
      ThemeControlSystem.init();

      // Update preview every second
      setInterval(() => {
        ThemeControlSystem.updatePreview();
      }, 1000);
    }

    console.log('üïê Self-Contained Digital Clock Theme Loaded!');
    console.log('üîß themeInit exists:', typeof themeInit);
    console.log('üé≠ themeRender exists:', typeof themeRender);
    console.log('üéõÔ∏è Theme Control System:', typeof ThemeControlSystem !== 'undefined' ? 'Ready' : 'Not Available');
  </script>
</body>
</html>