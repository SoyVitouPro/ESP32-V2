<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Digital Clock Theme</title>
  </head>
  <body>
    <!-- FPS hint read by the uploader UI (1–30). -->
    <fps>2</fps>

    <!--
      Digital Clock Theme with LED-style display
      - Clean digital clock appearance
      - Support for Khmer numbers
      - Blinking colon effect
      - Multiple color schemes
    -->
    <script>
      function themeInit() {
        return {
          // Time format
          format: '24',                   // '24' or '12'
          language: 'english',            // 'khmer', 'english'
          showSeconds: true,

          // Colors - LED style
          color: '#00ff00',               // green LED
          bg: '#001100',                  // very dark green
          accentColor: '#004400',         // darker green for effects

          // Style
          weight: 'normal',
          fontFamily: 'monospace, Courier New, system-ui',

          // Effects
          blinkColon: true,               // blinking colon effect
          showFrame: true,                // show border frame
          frameColor: '#006600'           // frame color
        };
      }

      function pad(n) { return (n < 10 ? '0' : '') + n; }

      function toKhmerNumber(n) {
        const khmerDigits = ['០', '១', '២', '៣', '៤', '៥', '៦', '៧', '៨', '៩'];
        return n.toString().split('').map(d => khmerDigits[parseInt(d)] || d).join('');
      }

      function formatTime(state, d) {
        let h = d.getHours();
        let m = d.getMinutes();
        let s = d.getSeconds();
        let suffix = '';

        if (state.format === '12') {
          suffix = (h < 12) ? ' AM' : ' PM';
          h = h % 12;
          if (h === 0) h = 12;
        }

        let timeStr = '';
        if (state.language === 'khmer') {
          timeStr = toKhmerNumber(h) + ':' + toKhmerNumber(m);
          if (state.showSeconds) {
            timeStr += ':' + toKhmerNumber(s);
          }
        } else {
          timeStr = pad(h) + ':' + pad(m);
          if (state.showSeconds) {
            timeStr += ':' + pad(s);
          }
        }

        return timeStr + suffix;
      }

      function themeRender(ctx, w, h, state, t) {
        // Clear background
        ctx.fillStyle = state.bg || '#001100';
        ctx.fillRect(0, 0, w, h);

        // Draw frame if enabled
        if (state.showFrame) {
          ctx.strokeStyle = state.frameColor || '#006600';
          ctx.lineWidth = 2;
          ctx.strokeRect(2, 2, w - 4, h - 4);

          // Inner frame
          ctx.strokeStyle = state.frameColor || '#006600';
          ctx.lineWidth = 1;
          ctx.strokeRect(4, 4, w - 8, h - 8);
        }

        // Get current time
        const now = new Date(t || Date.now());
        const timeText = formatTime(state, now);

        // Determine colon visibility for blinking effect
        const seconds = now.getSeconds();
        const showColon = !state.blinkColon || (seconds % 2 === 0);

        // Prepare text with optional colon hiding
        let displayText = timeText;
        if (!showColon && state.blinkColon) {
          // Hide colons for blinking effect
          displayText = timeText.replace(/:/g, ' ');
        }

        // Set font for digital display
        const size = Math.max(12, Math.floor(Math.min(w, h) * 0.25));
        ctx.font = `${state.weight || 'normal'} ${size}px ${state.fontFamily || 'monospace'}`;
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';

        // Add subtle glow effect
        ctx.shadowColor = state.color || '#00ff00';
        ctx.shadowBlur = 3;
        ctx.fillStyle = state.color || '#00ff00';

        // Draw time
        ctx.fillText(displayText, Math.floor(w * 0.5), Math.floor(h * 0.5));

        // Remove shadow for clean display
        ctx.shadowBlur = 0;

        // Draw accent elements (corner indicators)
        if (state.showFrame) {
          ctx.fillStyle = state.accentColor || '#004400';
          const cornerSize = 6;

          // Top-left corner
          ctx.fillRect(0, 0, cornerSize, 2);
          ctx.fillRect(0, 0, 2, cornerSize);

          // Top-right corner
          ctx.fillRect(w - cornerSize, 0, cornerSize, 2);
          ctx.fillRect(w - 2, 0, 2, cornerSize);

          // Bottom-left corner
          ctx.fillRect(0, h - 2, cornerSize, 2);
          ctx.fillRect(0, h - cornerSize, 2, cornerSize);

          // Bottom-right corner
          ctx.fillRect(w - cornerSize, h - 2, cornerSize, 2);
          ctx.fillRect(w - 2, h - cornerSize, 2, cornerSize);
        }

        // Optional: Add AM/PM indicator for 12-hour format
        if (state.format === '12') {
          const ampm = now.getHours() < 12 ? 'AM' : 'PM';
          ctx.font = `${state.weight || 'normal'} ${Math.floor(size * 0.4)}px ${state.fontFamily || 'monospace'}`;
          ctx.fillStyle = state.accentColor || '#004400';
          ctx.textAlign = 'right';
          ctx.textBaseline = 'top';
          ctx.fillText(ampm, w - 8, 8);
        }
      }
    </script>
  </body>
</html>